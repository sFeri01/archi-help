name: Generate PDF from README

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Convert README to PDF
        uses: docker://pandoc/extra:latest
        with:
          args: >-
            --pdf-engine=xelatex
            -V geometry:margin=2cm
            -V lang=hu
            -V title="Archi seg√©dlet"
            -V table-use-row-colors
            --template eisvogel
            -V secnumdepth=3
            -V header-includes=newcounter{none}
            --syntax-highlighting=idiomatic
            --toc
            -V toc-own-page
            --number-sections
            --shift-heading-level-by=-1
            -o Archi.pdf
            -f markdown+pipe_tables
            README.md

      - name: Release PDF
        uses: softprops/action-gh-release@v2
        with:
          files: |
            Archi.pdf
            Archi.tex
          tag_name: latest-pdf
          name: Release ${{ github.run_number }}
          body: "Auto-generated PDF from README.md from commit ${{ github.sha }}"
